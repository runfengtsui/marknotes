---
Title: 电子科技大学 2011 年攻读硕士学位研究生入学试题 844 数值计算
Author: 邱彼郑楠
Date: 2023-02-27
Modified: 2023-03-01
Category: Numerical Analysis
Tags: Numerical Analysis
Slug: uestc-2011
---

> 在区间 $[1, 4]$ 上用二分法求方程 $x^3+x-4=0$ 的近似根，要求误差不超过 $10^{-3}$ 所需二分次数至少为 __________.

**Solution**. 由题设，$a=1, b=4, \epsilon=10^{-3}$，则

$$
\log_2\left(\frac{b-a}{\epsilon}\right)-1=\log_2\left(3\times 10^3\right)-1\approx 10.55,
$$

于是所需二分次数至少为 11.

> 三阶矩阵 $A=\begin{bmatrix} 4 & 9 & 2 \\ 3 & 5 & 7 \\ 8 & 1 & 6 \end{bmatrix}$，而 $\boldsymbol{x}=\begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}$，则 $\lVert A\rVert_\infty=$ __________，$\lVert\boldsymbol{x}\rVert_\infty=$ __________.

**Solution**. 由题设，

$$
\lVert A\rVert_\infty=\max\lbrace 4+9+2, 3+5+7, 8+1+6\rbrace=15,
$$
$$
\lVert\boldsymbol{x}\rVert_\infty=\max\lbrace 1, 2, 3\rbrace=3.
$$

> 给定插值条件: $f(45)=60, f(90)=100$, 则 $f(x)$ 的线性插值函数为 __________.

**Solution**. 记 $x_0=45,x_1=90,f(x_0)=60,f(x_1)=100$, 则根据 Lagrange 插值公式，插值基函数分别为

$$
l_0(x)=\frac{x-x_1}{x_0-x_1}=-\frac{1}{45}(x-90),
$$
$$
l_1(x)=\frac{x-x_0}{x_1-x_0}=\frac{1}{45}(x-45),
$$

于是 $f(x)$ 的线性插值函数为

$$
y=f(x_0)l_0(x)+f(x_1)l_1(x)=\frac{4}{3}(x-90)+\frac{20}{9}(x-45).
$$

> 试写出 $\begin{cases} y'=\dfrac{y}{x}-2y^2 \\ y(0)=0 \end{cases}(0 < x < 3)$ 的 Euler 公式: __________.

**Solution**. 记 $f(x,y)=\dfrac{y}{x}-2y^2$, 则递推公式为

$$
y_{i+1}=y_i+hf(x_i,y_i)=y_i+h\left(\frac{y_i}{x_i}-2y_i^2\right),i=0,1,2,\cdots.
$$

所以该初值问题的 Euler 公式为

$$
\begin{cases}
y_0=0, \\
y_{i+1}=y_i+h\left(\dfrac{y_i}{x_i}-2y_i^2\right),i=0,1,2,\cdots.
\end{cases}
$$

> 用列主元法解
> $$
> \begin{bmatrix}
> -3 & 2 & 6 \\
> 10 & -7 & 0 \\
> 5 & -1 & 5
> \end{bmatrix}\begin{bmatrix}
> x_1 \\ x_2 \\ x_3
> \end{bmatrix}=\begin{bmatrix}
> 4 \\ 7 \\ 6
> \end{bmatrix}.
> $$

**Solution**. 应用列主元法求解该线性方程组的过程如下

$$
\begin{aligned}
&\begin{bmatrix}
-3 & 2 & 6 & 4 \\
10 & -7 & 0 & 7 \\
5 & -1 & 5 & 6
\end{bmatrix}\overset{r_1\leftrightarrow r_2}{\longrightarrow}\begin{bmatrix}
10 & -7 & 0 & 7 \\
-3 & 2 & 6 & 4 \\
5 & -1 & 5 & 6
\end{bmatrix} \\
\underset{r_3-\frac{1}{2}r_1}{\overset{r_2+\frac{3}{10}r_1}{\longrightarrow}}&\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & -\frac{1}{10} & 6 & \frac{61}{10} \\
0 & \frac{5}{2} & 5 & \frac{5}{2}\
\end{bmatrix}\overset{r_2\leftrightarrow r_3}{\longrightarrow}\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & \frac{5}{2} & 5 & \frac{5}{2} \\
0 & -\frac{1}{10} & 6 & \frac{61}{10}
\end{bmatrix} \\
\overset{r_3+\frac{1}{25}r_2}{\longrightarrow}&\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & \frac{5}{2} & 5 & \frac{5}{2} \\
0 & 0 & \frac{31}{5} & \frac{31}{5}
\end{bmatrix}\overset{r_3\times\frac{5}{31}}{\longrightarrow}\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & \frac{5}{2} & 5 & \frac{5}{2} \\
0 & 0 & 1 & 1
\end{bmatrix} \\
\overset{r_2-5r_3}{\longrightarrow}&\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & \frac{5}{2} & 0 & -\frac{5}{2} \\
0 & 0 & 1 & 1
\end{bmatrix}\overset{r_2\times\frac{2}{5}}{\longrightarrow}\begin{bmatrix}
10 & -7 & 0 & 7 \\
0 & 1 & 0 & -1 \\
0 & 0 & 1 & 1
\end{bmatrix} \\
\overset{r_1+7r_2}{\longrightarrow}&\begin{bmatrix}
10 & 0 & 0 & 0 \\
0 & 1 & 0 & -1 \\
0 & 0 & 1 & 1
\end{bmatrix}\overset{r_1\times\frac{1}{10}}{\longrightarrow}\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & -1 \\
0 & 0 & 1 & 1
\end{bmatrix}.
\end{aligned}
$$

所以方程组的解为 $(x_1,x_2,x_3)^T=(0, -1, 1)^T$.

> 利用 Taylor 展开式证明下面两种矩形公式
>
> (1) $\displaystyle\int_a^b f(x)\,\mathrm{d}x=(b-a)f(a)+\frac{(b-a)^2}{2}f'(\xi)$,
>
> (2) $\displaystyle\int_a^b f(x)\,\mathrm{d}x=(b-a)f(b)-\frac{(b-a)^2}{2}f'(\eta)$.

**Proof**. 利用 Taylor 定理，将 $f(x)$ 分别在 $x=a$ 和 $x=b$ 处展开有

$$
f(x)=f(a)+f'(\alpha)(x-a),\quad a < \alpha < x,
$$
$$
f(x)=f(b)+f'(\beta)(x-b),\quad x < \beta < b.
$$

于是，根据积分中值定理，存在 $\xi\in (a,b)$ 使得

$$
\begin{aligned}
\int_a^b f(x)\,\mathrm{d}x&=(b-a)f(a)+\int_a^b f'(\alpha)(x-a)\,\mathrm{d}x \\
&=(b-a)f(a)+f'(\xi)\int_a^b (x-a)\,\mathrm{d}x \\
&=(b-a)f(a)+\frac{(b-a)^2}{2}f'(\xi),
\end{aligned}
$$

同理，存在 $\eta\in (a,b)$ 使得

$$
\int_a^b f(x)\,\mathrm{d}x=(b-a)f(b)-\frac{(b-a)^2}{2}f'(\eta).
$$

> **Remark**. 本题还有一种思路是把积分看成变上限函数在某点的取值，则只需要对变上限函数进行展开即可。

> 证明二分法收敛定理: 设 $x^*$ 为方程 $f(x)=0$ 在区间 $[a,b]$ 的唯一根，且函数 $f(x)$ 满足条件 $f(a)f(b) < 0$, 则由二分法计算产生的第 $n$ 个区间 $[a_n,b_n)$ 的中点 $x_n$ 满足不等式
> $$
> \left\lvert x_n-x^*\right\rvert\le\frac{b-a}{2^{n+1}},
> $$
> 由此证明二分法收敛定理。

**Proof**. 二分法操作过程中每一个有根区间的长度均为前一个有根区间长度的一半，则产生的第 $n$ 个区间 $[a_n,b_n)$ 的长度为

$$
b_n-a_n=\frac{b-a}{2^n}.
$$

注意到 $x_n$ 为区间 $[a_n,b_n)$ 的中点，于是

$$
\begin{aligned}
\lvert x_n-x^*\rvert&=\left\lvert\frac{a_n+b_n}{2}-x^*\right\rvert=\frac{1}{2}\lvert(a_n-x^*)+(b_n-x^*)\rvert \\
&\le\frac{1}{2}(\lvert a_n-x^*\rvert+\lvert b_n-x^*\rvert)=\frac{1}{2}(x^*-a_n+b_n-x^*) \\
&=\frac{b_n-a_n}{2}=\frac{b-a}{2^{n+1}}.
\end{aligned}
$$

注意到 $\lim\limits_{n\to\infty}\dfrac{b-a}{2^{n+1}}=0$, 由迫敛性可知 $\lim\limits_{n\to\infty}\lvert x_n-x^*\rvert=0$, 即 $\lim\limits_{n\to\infty} x_n=x^*$.

> 用最小二乘法求一个如 $Y=Ae^{Bx}$ 的经验公式，使与下列数据相拟合
>
> |$x$|1|2|3|4|
> |:-:|:-:|:-:|:-:|:-:|
> |$y$|60|30|20|15|

**Solution**. 作变换令 $t=x,z=\ln Y$, 则有 $z=\alpha+\beta t$, 其中 $\alpha=\ln A,\beta=B$.

将题目中的数据 $(x,y)$ 转化为 $(t,z)$ 有

|$t$|1|2|3|4|
|:-:|:-:|:-:|:-:|:-:|
|$z$|4.0943|3.4012|2.9957|2.7081|

取 $\varphi_0(t)=1,\varphi_1(t)=t$, 则

$$
(\varphi_0,\varphi_0)=\sum_{i=1}^4 \varphi_0^2(t_i)=4,\quad (\varphi_0,\varphi_1)=\sum_{i=1}^4 \varphi_0(t_i)\varphi_1(t_i)=10,
$$
$$
(\varphi_1,\varphi_0)=\sum_{i=1}^4 \varphi_1(t_i)\varphi_0(t_i)=10,\quad (\varphi_1,\varphi_1)=\sum_{i=1}^4 \varphi_1^2(t_i)=30,
$$
$$
(\varphi_0,z)=\sum_{i=1}^4 \varphi_0(t_i)z(t_i)=13.1993,\quad (\varphi_1,z)=\sum_{i=1}^4\varphi_1(t_i)z(t_i)=30.7162.
$$

于是法方程组为

$$
\begin{pmatrix}
4 & 10 \\ 10 & 30
\end{pmatrix}\begin{pmatrix}
\alpha \\ \beta
\end{pmatrix}=\begin{pmatrix}
13.1993 \\ 30.7162
\end{pmatrix}.
$$

解得 $\alpha\approx 4.4408,\beta\approx-0.4564$, 从而 $A=e^\alpha\approx 84.8428,B=\beta=-0.4564$. 故所求的经验公式为

$$
Y=84.8428e^{-0.4564x}.
$$

> 用 Newton 公式计算
> $$
> x-1=\frac{1}{x+2},
> $$
> 取 $x_0=1$, 求 $x_1,x_2$.

**Solution**. 记 $f(x)=x-1-\dfrac{1}{x+2}$, 则 $f'(x)=1+\dfrac{1}{(x+2)^2}$. 于是 Newton 迭代公式为

$$
x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}=x_n-\frac{x_n-1-\frac{1}{x_n+2}}{1+\frac{1}{(x_n+2)^2}}
$$

将 $x_0=1$ 代入得

$$
x_1=1-\frac{-\frac{1}{3}}{1+\frac{1}{3^2}}=1.3,
$$

进一步将 $x_1=1.3$ 代入得

$$
x_2=1.3-\frac{0.3-\frac{1}{3.3}}{1+\frac{1}{3.3^2}}\approx 1.3028.
$$

> **Remark**. 本题更简单的构造函数的方法是两边同乘以 $x+2$, 这种方法计算得到的 $x_1=\frac{4}{3}$.

> 用最小二乘法解超定方程组
> $$
> \begin{cases}
> 2x+4y=11 \\
> 3x-5y=3 \\
> x+2y=6 \\
> 4x+2y=14
> \end{cases}
> $$

**Solution**. 记 $A=\begin{pmatrix} 2 & 4 \\ 3 & -5 \\ 1 & 2 \\ 4 & 2 \end{pmatrix}$, $\boldsymbol{b}=\begin{pmatrix} 11 \\ 3 \\ 6 \\ 14 \end{pmatrix}$, 则

$$
A^TA=\begin{pmatrix}
2 & 3 & 1 & 4 \\
4 & -5 & 2 & 2
\end{pmatrix}\begin{pmatrix}
2 & 4 \\
3 & -5 \\
1 & 2 \\
4 & 2
\end{pmatrix}=\begin{pmatrix}
30 & 3 \\
3 & 49
\end{pmatrix},
$$
$$
A^T\boldsymbol{b}=\begin{pmatrix}
2 & 3 & 1 & 4 \\
4 & -5 & 2 & 2
\end{pmatrix}\begin{pmatrix}
11 \\ 3 \\ 6 \\ 14
\end{pmatrix}=\begin{pmatrix}
93 \\ 69
\end{pmatrix}.
$$

又因为

$$
\left(A^TA\right)^{-1}=\frac{1}{\left\lvert A^TA\right\rvert}\left(A^TA\right)^*=\frac{1}{1461}\begin{pmatrix}
49 & -3 \\
-3 & 30
\end{pmatrix}.
$$

故超定方程组的最小二乘解为

$$
\boldsymbol{x}=\left(A^TA\right)^{-1}A^T\boldsymbol{b}=\frac{1}{1461}\begin{pmatrix}
49 & -3 \\
-3 & 30
\end{pmatrix}\begin{pmatrix}
93 \\ 69
\end{pmatrix}=\frac{1}{487}\begin{pmatrix}
1450 \\ 597
\end{pmatrix}
$$

> 求证梯形公式
> $$
> \int_a^b f(x)\,\mathrm{d}x=\frac{b-a}{2}(f(a)+f(b)),
> $$
> 具有一阶代数精度。

**Proof**. 取 $f(x)=1$, 有 $\displaystyle\int_a^b f(x)\,\mathrm{d}x=b-a=\frac{b-a}{2}(f(a)+f(b))$.

再取 $f(x)=x$, 有

$$
LHS=\int_a^b f(x)\,\mathrm{d}x=\frac{1}{2}\left(b^2-a^2\right),
$$
$$
RHS=\frac{b-a}{2}(f(a)+f(b))=\frac{1}{2}\left(b^2-a^2\right).
$$

显然 $\displaystyle\int_a^b f(x)\,\mathrm{d}x=\frac{b-a}{2}(f(a)+f(b))$.

而当取 $f(x)=x^2$ 时，

$$
LHS=\int_a^b f(x)\,\mathrm{d}x=\frac{1}{3}\left(b^3-a^3\right),
$$
$$
RHS=\frac{b-a}{2}\left(a^2+b^2\right)=\frac{1}{2}\left(b^3-ab^2+a^2b-a^3\right).
$$

由于 $LHS\neq RHS$, 故梯形公式具有一阶代数精度。

> 求定积分的梯形公式
> $$
> \int_a^b f(x)\,\mathrm{d}x=\frac{b-a}{2}(f(a)+f(b))+R_1(f),
> $$
> 中的误差 $R_1(f)=-\dfrac{(b-a)^3}{12}f''(\xi)$. 由此推导复合梯形公式
> $$
> \int_a^b f(x)\,\mathrm{d}x=\frac{h}{2}\left(f(a)+f(b)+2\sum_{j=1}^{n-1}f(x_j)\right)+R_2(f),
> $$
> 的误差表达式为 $R_2(f)=-\dfrac{(b-a)^3}{12n^2}f''(\eta),\eta\in(a,b)$.

**Proof**. 根据 Lagrange 插值公式，取积分区间 $[a,b]$ 的两个端点 $x_0=a,x_1=b$ 构造线性插值函数

$$
f(x)=\frac{x-x_1}{x_0-x_1}f(x_0)+\frac{x-x_0}{x_1-x_0}f(x_1)+\frac{f''(\zeta)}{2}(x-x_0)(x-x_1),
$$

则梯形公式为

$$
\begin{aligned}
\int_a^b f(x)\,\mathrm{d}x&=f(x_0)\int_a^b \frac{x-x_1}{x_0-x_1}\,\mathrm{d}x+f(x_1)\int_a^b \frac{x-x_0}{x_1-x_0}\,\mathrm{d}x+\int_a^b \frac{f''(\zeta)}{2}(x-x_0)(x-x_1)\,\mathrm{d}x \\
&=\frac{b-a}{2}(f(a)+f(b))+R_1(f),
\end{aligned}
$$

其中 $R_1(f)=\displaystyle\int_a^b \frac{f''(\zeta)}{2}(x-a)(x-b)\,\mathrm{d}x$. 根据积分中值定理，存在 $\xi\in (a,b)$ 使得

$$
R_1(f)=\frac{f''(\xi)}{2}\int_a^b (x-a)(x-b)\,\mathrm{d}x=-\frac{(b-a)^3}{12}f''(\xi).
$$

将区间 $[a,b]$ 平均分成 $n$ 个小区间，分点为 $x_j=a+jh,h=\dfrac{b-a}{n},j=0,1,\,\cdots,n$. 利用定积分的性质有

$$
\int_a^b f(x)\,\mathrm{d}x=\sum_{j=0}^{n-1}\int_{x_j}^{x_{j+1}} f(x)\,\mathrm{d}x,
$$

在每个小区间上使用梯形求积公式，有

$$
\begin{aligned}
\int_a^b f(x)\,\mathrm{d}x&=\frac{h}{2}\sum_{j=0}^{n-1} (f(x_j)+f(x_{j+1}))+\sum_{j=0}^{n-1}\left(-\frac{h^3}{12}f''(\xi_j)\right) \\
&=\frac{h}{2}\left(f(a)+f(b)+2\sum_{j=1}^{n-1}f(x_j)\right)+R_2(f),
\end{aligned}
$$

其中

$$
R_2(f)=\sum_{j=0}^{n-1}\left(-\frac{h^3}{12}f''(\xi_j)\right)=-\frac{nh^3}{12}\cdot\frac{1}{n}\sum_{j=0}^{n-1} f''(\xi_k).
$$

由连续函数的介值定理存在 $\eta\in (a,b)$ 使得

$$
R_2(f)=-\frac{(b-a)h^2}{12}f''(\eta)=-\frac{(b-a)^3}{12n^3}f''(\eta).
$$

> 求下列高阶微分方程的数值解(化为一阶微分方程组，再用 Runge-Kutta 公式 `ode23()` 编写程序):
> $$
> \begin{cases}
> y'''-y''+2y'y=0 \\
> y(0)=0,y'(0)=0,y''(0)=-1
> \end{cases}(0\le x\le 3).
> $$

**Solution**. 令 $u_1=y,u_2=y,u_3=y''$, 则原方程可化为

$$
\begin{cases}
u_1'=u_2, \\
u_2'=u_3, \\
u_3'=u_3-2u_2u_1, \\
u_1(0)=0,u_2(0)=0,u_3(0)=-1.
\end{cases}
$$

下面使用北太天元软件的 `ode23()` 函数求解程序如下:

```matlab
% f.m
function dudt=f(t, u)
	dudt = [u(2); u(3); u(3)-2*u(2)*u(1)];
end

% main.m
clc; clear;
odefun = @f;
u0 = [0; 0; -1];
[t, y] = ode23(odefun, [0 3], u0);
plot(t, y(1), t, y(2), t, y(3));
```
